"0","# Extract the R-squared of each country's fitted linear model"
"0","country_fit <- by_country %>%"
"0","  mutate(model = map(model, broom::glance)) %>%"
"0","  unnest(model)"
"0",""
"0","n <- length(unique(gapminder2$country))"
"0",""
"0","country_fit <- tibble(country = gapminder2$country[seq(1,1704,12)],"
"0","                      continent = gapminder2$continent[seq(1,1704,12)],"
"0","                      intercept = rep(0,n),"
"0","                      year1952 = rep(0,n),"
"0","                      r.squared = rep(0,n))"
"0","for (i in 1:n) {"
"0","  sub <- gapminder2 %>% filter(country == country_fit$country[i])"
"0","  sub_lm <- lm(lifeExp~year1952, data=sub)"
"0","  sub_lm_coefs <- coefficients(sub_lm)"
"0","  country_fit$intercept[i] <- sub_lm_coefs[1]"
"0","  country_fit$year1952[i] <- sub_lm_coefs[2]"
"0","  country_fit$r.squared[i] <- summary(sub_lm)$r.squared"
"0","}"
"0",""
"0","country_fit"
