"0","# Group by country then nest"
"0","by_country <- gapminder2 %>%"
"0","  select(country, year1952, lifeExp, continent) %>%"
"0","  group_by(country, continent) %>% # Country cannot belong in multiple continents so including this will add another column of information without creating a second group"
"0","  nest()"
"0",""
"0",""
"0","# Load purrr"
"0","library(purrr)"
"0",""
"0","# Using mutate to fit a model for each country stores them in by_country"
"0","by_country <- by_country %>%"
"0","  mutate(model = map(data, ~lm(lifeExp~year1952, data = .)))"
"0",""
"0","# Unnest the model column but do so in a tidy way that returns the intercept and slope coefficient"
"0","country_coefs <- by_country %>%"
"0","  mutate(model = map(model, broom::tidy)) %>%"
"0","  unnest(model)"
"0",""
"0","# Wrangle the data - intercept and slope coefficient as columns"
"0","country_coefs <- country_coefs %>%"
"0","  select(country, continent, term, estimate) %>%"
"0","  spread(term, estimate)%>%"
"0","  rename(intercept = `(Intercept)`)"
"0",""
"0","head(country_coefs)"
